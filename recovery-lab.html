<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HRV & Readiness Lab | Academic Athlete Lab</title>
    <meta name="description" content="Calculate your recovery readiness score. Specialized HRV and sleep diagnostic for athletes 50+ to optimize training load and prevent overreaching.">
    <meta name="keywords" content="HRV calculator, recovery score, readiness to train, masters athlete HRV, sleep recovery, autonomic balance">
    
    <!-- Canonical for SEO -->
    <link rel="canonical" href="https://academicathletelab.com/recovery-lab.html">

    <!-- Structured data for better search visibility -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "HRV & Readiness Lab - Academic Athlete Lab",
      "description": "Recovery readiness diagnostic for athletes 50+ using HRV and sleep metrics to guide training and prevent overtraining.",
      "url": "https://academicathletelab.com/recovery-lab.html"
    }
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="nav.js" defer></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Inter:wght@400;700;900&display=swap');
        
        body { 
            background-color: #050505; 
            color: #fff; 
            font-family: 'Inter', sans-serif; 
            -webkit-font-smoothing: antialiased; 
            margin: 0;
            padding: 0;
            padding-top: 80px; 
        }
        
        .font-mono { font-family: 'Space Mono', monospace; }
        .safety-teal { color: #2dd4bf; }
        .bg-teal { background-color: #2dd4bf; }
        .glass-card { background: #111; border: 1px solid #222; }
        .input-field { 
            background: #000; 
            border: 1px solid #333; 
            color: #2dd4bf; 
            outline: none; 
            transition: all 0.2s; 
            font-size: 1.1rem; 
            width: 100%; 
            padding: 1rem; 
            border-radius: 0.75rem; 
        }
        .input-field:focus { border-color: #2dd4bf; background: #0a0a0a; }
        .toggle-active { background-color: #2dd4bf !important; color: #fff !important; }
        
        /* Improved affiliate buttons */
        .affiliate-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 1rem 1.5rem;
            font-size: 1rem;
            font-weight: 700;
            border-radius: 0.75rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            min-width: 220px;
        }
        .affiliate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.4);
        }
        
        .error-message { color: #ef4444; font-size: 0.875rem; margin-top: 0.25rem; }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>

<body class="min-h-screen flex flex-col" onload="initPage()">

    <!-- Shared nav injected here by nav.js -->

    <main class="max-w-5xl mx-auto p-6 md:p-12 w-full font-inter">
        <header class="mb-12 text-left">
            <div class="inline-block bg-teal text-black px-4 py-1 font-black italic text-2xl uppercase mb-4 tracking-tighter">HRV & Readiness Lab</div>
            <p class="text-neutral-500 text-[10px] tracking-[0.4em] uppercase font-mono font-bold">Diagnostic: Autonomic Balance</p>
        </header>

        <div class="grid lg:grid-cols-2 gap-10 items-start text-left">
            <section class="glass-card p-8 rounded-3xl border-l-4 border-teal-500">
                <h3 class="text-xs font-bold uppercase safety-teal mb-6 tracking-widest font-mono italic">Autonomic Inputs</h3>
                <div class="space-y-6">
                    <div>
                        <label class="block text-[10px] uppercase text-neutral-500 font-bold mb-2 font-mono tracking-widest">Biological Sex</label>
                        <div class="flex bg-black border border-neutral-800 rounded-xl p-1">
                            <button id="gen-male" onclick="setGender('male')" class="flex-1 py-3 text-[10px] font-bold rounded-lg transition-all">MALE</button>
                            <button id="gen-female" onclick="setGender('female')" class="flex-1 py-3 text-[10px] font-bold rounded-lg transition-all">FEMALE</button>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-[10px] uppercase text-neutral-500 font-bold mb-2 font-mono tracking-widest">Today's HRV (ms)</label>
                            <input type="number" id="hrv" placeholder="65" oninput="calculateReadiness()" class="input-field font-mono text-2xl">
                            <div id="hrv-error" class="error-message hidden"></div>
                        </div>
                        <div>
                            <label class="block text-[10px] uppercase text-neutral-500 font-bold mb-2 font-mono italic tracking-widest">7-Day Baseline (ms)</label>
                            <input type="number" id="hrv-base" placeholder="60" oninput="calculateReadiness()" class="input-field font-mono text-2xl">
                            <div id="base-error" class="error-message hidden"></div>
                        </div>
                    </div>
                    <div>
                        <label class="block text-[10px] uppercase text-neutral-500 font-bold mb-2 font-mono tracking-widest">Sleep Duration (Hours)</label>
                        <input type="number" id="sleep" step="0.1" placeholder="7.5" oninput="calculateReadiness()" class="input-field font-mono text-2xl">
                        <div id="sleep-error" class="error-message hidden"></div>
                    </div>
                    <button onclick="resetLab()" class="text-[9px] text-neutral-600 hover:text-teal-500 uppercase font-bold tracking-widest pt-2">Clear Data</button>
                </div>
            </section>

            <section class="glass-card p-8 rounded-3xl flex flex-col justify-center min-h-[450px] relative overflow-hidden">
                <div id="result-display" class="hidden text-left relative z-10">
                    <span class="text-[10px] font-bold uppercase text-teal-500 tracking-[0.3em] font-mono italic text-left block">Readiness Status</span>
                    <div class="text-7xl md:text-8xl font-black text-white italic tracking-tighter mb-4 leading-none uppercase" id="readiness-val">--</div>
                    
                    <div class="p-6 bg-teal-500/5 border border-teal-500/20 rounded-2xl mb-6">
                        <p class="text-[9px] font-bold text-teal-400 uppercase mb-2 tracking-widest italic text-left underline font-mono">Training Prescription:</p>
                        <p id="recovery-comment" class="text-xs italic text-neutral-400 leading-relaxed font-inter"></p>
                    </div>

                    <!-- Improved Affiliate Recommendations -->
                    <div class="mt-8 grid md:grid-cols-2 gap-6">
                        <a href="https://amzn.to/4c0YSaS" target="_blank" rel="noopener noreferrer" class="affiliate-btn bg-teal-600 hover:bg-teal-500 text-white font-bold">
                            Ultima Replenisher Electrolyte Powder → (Amazon)
                        </a>
                        <a href="https://amzn.to/49OwZjK" target="_blank" rel="noopener noreferrer" class="affiliate-btn bg-teal-600 hover:bg-teal-500 text-white font-bold">
                            Oura Ring 4 → (Amazon)
                        </a>
                    </div>

                    <p class="text-neutral-500 text-xs mt-4 italic text-center">
                        As an Amazon Associate, I earn from qualifying purchases at no extra cost to you.
                    </p>

                    <div class="mt-8 pt-8 border-t border-neutral-900">
                        <a href="athlete-lab.html" class="block w-full text-center bg-teal-500 text-black font-black py-4 rounded-xl uppercase text-[10px] tracking-widest hover:bg-white transition-all italic font-inter">Commit to Streak Lab →</a>
                    </div>
                </div>
                <div id="idle-display" class="text-neutral-700 italic text-center uppercase text-[10px] tracking-widest font-mono px-12 leading-loose">
                    [ Awaiting autonomic and sleep metrics for neural restoration analysis ]
                </div>
                <div class="absolute -right-8 -bottom-8 text-9xl font-black text-white/[0.02] italic pointer-events-none select-none uppercase">Recover</div>
            </section>
        </div>

        <section class="mt-20 border-t border-neutral-900 pt-16 text-left">
            <h3 class="text-2xl font-black italic uppercase mb-8 safety-teal tracking-tighter font-inter">Research Protocol: Neural Restoration</h3>
            
            <div class="grid md:grid-cols-2 gap-12 text-neutral-400 text-sm leading-relaxed">
                <div class="space-y-6 font-inter">
                    <h4 class="text-white font-bold uppercase text-xs tracking-widest font-mono">The HRV Baseline Shift</h4>
                    <p>Heart Rate Variability (HRV) is the primary marker for the <strong>Autonomic Nervous System</strong>. For the 50+ athlete, we prioritize the stability of the baseline over the raw number. A significant drop in HRV indicates sympathetic dominance, signaling that your CNS is still processing the previous training load.</p>
                </div>
                <div class="space-y-6 font-inter">
                    <h4 class="text-white font-bold uppercase text-xs tracking-widest font-mono">Anabolic Sleep Windows</h4>
                    <p>Sleep architecture shifts as we age, often reducing Deep Slow Wave Sleep (SWS). For the masters athlete, sleep is the only phase where growth hormone release facilitates muscle repair. Falling below 7 hours creates a <strong>recovery debt</strong> that suppresses the immune response.</p>
                </div>
            </div>
        </section>

        <section class="mt-12 p-6 bg-neutral-900/30 border border-neutral-800 rounded-2xl text-left font-mono">
            <p class="text-[10px] text-neutral-500 leading-relaxed italic">
                <span class="text-neutral-300 font-bold uppercase tracking-widest block mb-2 underline font-inter">Diagnostic Disclaimer:</span>
                Recovery scores are physiological proxies. Correlate these results with perceived exertion (RPE) and morning mood. If you experience chronic fatigue, consult a physician for overtraining assessment.
            </p>
        </section>
    </main>

    <footer class="p-12 border-t border-neutral-900 mt-20 bg-black text-center font-mono text-[9px] text-neutral-600 uppercase tracking-[0.3em]">
        Academic Athlete Lab © 2026 | Protocol: Neural_Restoration_v5.1
    </footer>

    <script>
        let currentGender = localStorage.getItem('athleteGender') || 'male';

        function initPage() {
            setGender(currentGender);
            // Fields start blank on every refresh/load
            calculateReadiness();
        }

        function setGender(g) {
            currentGender = g;
            localStorage.setItem('athleteGender', g);
            document.getElementById('gen-male').className = g === 'male' ? 'flex-1 py-3 text-[10px] font-bold rounded-lg toggle-active' : 'flex-1 py-3 text-[10px] font-bold rounded-lg text-neutral-500';
            document.getElementById('gen-female').className = g === 'female' ? 'flex-1 py-3 text-[10px] font-bold rounded-lg toggle-active' : 'flex-1 py-3 text-[10px] font-bold rounded-lg text-neutral-500';
            calculateReadiness();
        }

        function calculateReadiness() {
            const hrv = parseFloat(document.getElementById('hrv').value);
            const base = parseFloat(document.getElementById('hrv-base').value);
            const sleep = parseFloat(document.getElementById('sleep').value);

            const hrvError = document.getElementById('hrv-error');
            const baseError = document.getElementById('base-error');
            const sleepError = document.getElementById('sleep-error');

            hrvError.classList.add('hidden');
            baseError.classList.add('hidden');
            sleepError.classList.add('hidden');

            if (!hrv || hrv <= 0) {
                hrvError.textContent = 'Enter a valid HRV (> 0 ms)';
                hrvError.classList.remove('hidden');
            }
            if (!base || base <= 0) {
                baseError.textContent = 'Enter a valid baseline (> 0 ms)';
                baseError.classList.remove('hidden');
            }
            if (!sleep || sleep <= 0) {
                sleepError.textContent = 'Enter a valid sleep duration (> 0 hours)';
                sleepError.classList.remove('hidden');
            }

            if (!hrv || hrv <= 0 || !base || base <= 0 || !sleep || sleep <= 0) {
                document.getElementById('result-display').classList.add('hidden');
                document.getElementById('idle-display').classList.remove('hidden');
                return;
            }

            const hrvRatio = hrv / base;
            let readiness = "";
            let comment = "";

            // Diagnostic Logic tailored for 50+ Athletes
            if (hrvRatio >= 1.05 && sleep >= 7.5) {
                readiness = "Prime";
                comment = "CNS is fully supercompensated. Optimal window for Maximum Intensity or 1RM testing. Push the ceiling today.";
            } else if (hrvRatio >= 0.9 && sleep >= 7) {
                readiness = "Functional";
                comment = "Autonomic balance is stable. Suitable for standard volume hypertrophy or Zone 2 endurance work.";
            } else if (hrvRatio >= 0.8 || (sleep < 7 && sleep >= 6)) {
                readiness = "Compromised";
                comment = "Parasympathetic suppression detected. Recommend a deload session. Limit RPE to 6/10 and focus on movement quality.";
            } else {
                readiness = "Critical";
                comment = "Systemic stress detected. High injury risk. Priority: Active recovery, inflammatory management, or total rest.";
            }

            document.getElementById('result-display').classList.remove('hidden');
            document.getElementById('idle-display').classList.add('hidden');
            document.getElementById('readiness-val').innerText = readiness;
            document.getElementById('recovery-comment').innerText = comment;
            
            localStorage.setItem('athleteHRV', hrv);
            localStorage.setItem('athleteHRVBase', base);
            localStorage.setItem('athleteSleep', sleep);
            localStorage.setItem('athleteReadiness', readiness);

            // Improved Affiliate Recommendations
            if (!document.getElementById('affiliate-box')) {  // Prevent duplicates
                const affiliateBox = document.createElement('div');
                affiliateBox.id = 'affiliate-box';
                affiliateBox.className = 'mt-8 grid md:grid-cols-2 gap-6';
                affiliateBox.innerHTML = `
                    <a href="https://amzn.to/4c0YSaS" target="_blank" rel="noopener noreferrer" class="affiliate-btn bg-teal-600 hover:bg-teal-500 text-white font-bold">
                        Ultima Replenisher Electrolyte Powder → (Amazon)
                    </a>
                    <a href="https://amzn.to/49OwZjK" target="_blank" rel="noopener noreferrer" class="affiliate-btn bg-teal-600 hover:bg-teal-500 text-white font-bold">
                        Oura Ring 4 → (Amazon)
                    </a>
                    <p class="text-neutral-500 text-xs mt-4 italic text-center col-span-2">
                        As an Amazon Associate, I earn from qualifying purchases at no extra cost to you.
                    </p>
                `;
                document.getElementById('result-display').appendChild(affiliateBox);
            }
        }

        function resetLab() {
            document.getElementById('hrv').value = '';
            document.getElementById('hrv-base').value = '';
            document.getElementById('sleep').value = '';
            document.getElementById('hrv-error').classList.add('hidden');
            document.getElementById('base-error').classList.add('hidden');
            document.getElementById('sleep-error').classList.add('hidden');
            calculateReadiness();
        }
    </script>
</body>
</html>
